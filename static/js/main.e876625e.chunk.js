(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{115:function(e,t,n){e.exports=n(158)},119:function(e,t,n){},158:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(26),o=n.n(i),c=(n(119),n(4)),u=n(47),l=n(44),s=n(23),f=(n(34),n(114)),d=n(113),p=b()?d.a:f.a,h="undefined"!==typeof window?window.location:{search:""};function v(){return!!b()&&0===h.search.indexOf("?debug")}function b(){return"web"===s.a.OS}var y=a.a.createContext(v()),m=v()?44:24,x=10,O=24,w=3,E=750,g="clockwise",S=[{name:"default",shapeColors:{i:"maroon",j:"silver",l:"purple",o:"navy",s:"green",t:"brown",z:"teal"}},{name:"gameboy",shapeColors:{i:"orange",j:"cyan",l:"red",o:"yellow",s:"Magenta",t:"green",z:"amber"}},{name:"red",shapeColors:{i:"red",j:"red",l:"red",o:"red",s:"red",t:"red",z:"red"}}];function j(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return S.find(function(t){return t.name===e})||S[0]}for(var T=a.a.createContext(j()),k=n(37),D=n(9),A=n(111),L=n.n(A),R=function(){return new L.a},C=function(e){var t=e.map(function(e){var t=e.x;return{x:-e.y,y:t}}),n=X(t,"bottom"),r=n[0],a=!0,i=!1,o=void 0;try{for(var c,u=n[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var l=c.value;(!r||l.x<r.x)&&(r=l)}}catch(d){i=!0,o=d}finally{try{a||null==u.return||u.return()}finally{if(i)throw o}}var s=r.x<0?-r.x:r.x,f=r.y<0?-r.y:r.y;return t.map(function(e){var t=e.x,n=e.y;return{x:t+s,y:n+f}})},I={i:[{x:0,y:0},{x:1,y:0},{x:2,y:0},{x:3,y:0}],j:[{x:0,y:0},{x:0,y:1},{x:1,y:0},{x:2,y:0}],l:[{x:0,y:0},{x:1,y:0},{x:2,y:0},{x:2,y:1}],o:[{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1}],s:[{x:0,y:0},{x:1,y:0},{x:1,y:1},{x:2,y:1}],t:[{x:0,y:0},{x:1,y:0},{x:2,y:0},{x:1,y:1}],z:[{x:0,y:1},{x:1,y:1},{x:1,y:0},{x:2,y:0}]},P=Object.keys(I),M={0:I,1:Object(D.a)({},I),2:Object(D.a)({},I),3:Object(D.a)({},I)},H=0;H<P.length;H++){var z=P[H],B=C(I[z]),W=C(B),N=C(W);M[1][z]=B,M[2][z]=W,M[3][z]=N}var U=R();function F(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:O,n=U.pickone(["o","i","s","z","l","j","t"]);return Object(D.a)({column:4,id:U.guid({version:4}),line:t-1,position:0,type:n},e)}function G(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x;return new Array(e).fill({}).map(function(){return{id:U.guid({version:4})}})}function K(e){return M[e.position][e.type]}function Q(e){switch(e){case 0:return"clockwise"===g?1:3;case 1:return"clockwise"===g?2:0;case 2:return"clockwise"===g?3:1;default:return"clockwise"===g?0:2}}function q(e,t){return e-t}function J(e){return K(e).map(function(t){var n=t.x,r=t.y;return{x:n+e.column,y:r+e.line}})}function X(e,t){var n="top"===t||"bottom"===t?function(e){var t={},n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,u=c.x,l=c.y;t[u]||(t[u]=[]),t[u].push(l)}}catch(s){r=!0,a=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return t}(e):function(e){var t={},n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,u=c.x,l=c.y;t[l]||(t[l]=[]),t[l].push(u)}}catch(s){r=!0,a=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return t}(e);return Object.keys(n).map(function(e){return{x:"left"===t||"right"===t?"right"===t?Math.max.apply(null,n[e]):Math.min.apply(null,n[e]):Number(e),y:"bottom"===t||"top"===t?"top"===t?Math.max.apply(null,n[e]):Math.min.apply(null,n[e]):Number(e)}})}function Y(e,t,n){var r=e.x,a=e.y;switch(t){case"bottom":return a<=1;case"left":return r<=0;case"right":return r>x-function(e){var t=K(e).map(function(e){return e.x}),n=Math.min.apply(null,t);return Math.max.apply(null,t)-n}(n)+(r-n.column)-1;case"top":return a>O-function(e){var t=K(e),n=Math.max.apply(null,t.map(function(e){return e.y}))+1,r=O-e.line;return r<n?r:n}(n)+(a-n.line)-1}return!0}function $(e,t,n){return void 0!==function(e,t){return X(J(e),t)}(t,n).find(function(r){var a=r.x,i=r.y,o=q(e.lines.length,i);if(Y({x:a,y:i},n,t))return!0;if("bottom"===n){if(i>e.lines.length)return!0;var c=e.lines[o+1][a];return!(!c.partOfShape||c.partOfShape.shape.id===t.id)}if("left"===n){if(i<=0)return!1;var u=e.lines[o][a-1];return void 0!==u.partOfShape&&u.partOfShape.shape.id!==t.id}if("right"===n){if(a+1>=e.lines[o].length)return!0;var l=e.lines[o][a+1];return void 0!==l.partOfShape&&l.partOfShape.shape.id!==t.id}return!1})}var V=R();function Z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x;return{activeShape:void 0,id:V.guid({version:4}),lines:Array.from(new Array(e)).map(function(){return Array.from(new Array(t)).map(function(){return{id:V.guid({version:4})}})}),previewBoards:[],shapeQueue:[]}}function _(e,t){if(!t)return Object(k.a)(e);var n=J(t);return e.map(function(r,a){var i=q(e.length,a);return r.map(function(e,r){if(void 0!==n.find(function(e){var t=e.x;return e.y===i&&t===r})){var a=R().guid();return Object(D.a)({},e,{partOfShape:{id:a,order:1,shape:t}})}return e.partOfShape&&e.partOfShape.shape.id===t.id?Object(D.a)({},e,{partOfShape:void 0}):Object(D.a)({},e)})})}function ee(e){var t=R();return{board:Z(),gameOver:!1,id:t.guid({version:4}),level:1,lines:0,paused:!1,previous:e,score:0,ticks:0}}var te=a.a.useReducer,ne=a.a.useEffect,re=a.a.useLayoutEffect,ae=a.a.useState,ie=a.a.useRef,oe=ee(),ce=function(e,t){if(!0===e.gameOver&&"RESTART"!==t.type)return e;if(e.paused&&"PAUSE"!==t.type)return e;switch(t.type){case"PAUSE":return Object(D.a)({},e,{paused:!e.paused});case"DOWN":case"THICK":var n=function(e){for(var t=Object(k.a)(e.shapeQueue),n=e.shapeQueue.length;n<w;n++)t[n]=F({},e.lines.length);return[t.slice(1),t[0]]}(e.board),r=Object(u.a)(n,2),a=r[0],i=r[1],o=$(e.board,i,"bottom"),c=e.board.activeShape,l=!1,s=e.board.lines,f=0;if(c)if(!!c&&$(e.board,c,"bottom")){c=void 0;var d=function(e){var t=0;return[e.lines.reduce(function(e,n){return function(e){return void 0===e.find(function(e){return function(e){return!e.partOfShape||!e.partOfShape.id}(e)})}(n)?(t++,[G()].concat(Object(k.a)(e.slice()))):[].concat(Object(k.a)(e),[n])},[]),t]}(e.board),p=Object(u.a)(d,2);s=p[0],f=p[1]}else c=Object(D.a)({},c,{line:c.line-1});else l=!!(c=o?void 0:i)&&c.id===i.id;var h=l?a:[i].concat(Object(k.a)(a.slice(0,a.length))),v=e.lines+f,b=function(e){return Math.floor(e/5)+1}(v);return Object(D.a)({},e,{board:Object(D.a)({},e.board,{activeShape:c,lines:_(s,c),previewBoards:h.map(function(e){var t=Z(4,4),n=Object(D.a)({},e,{column:0,line:1});return Object(D.a)({},t,{lines:_(t.lines,n)})}),shapeQueue:h}),endDate:void 0===c&&o?new Date:void 0,gameOver:!(void 0!==c||!o),level:b,lines:v,startDate:0===e.ticks?new Date:e.startDate,ticks:t.payload?Number(t.payload):e.ticks});case"BLAST":var y=e.board.activeShape;if(!y)return e;for(var m=$(e.board,y,"bottom");!m;)y=Object(D.a)({},y,{line:y.line-1}),m=$(e.board,y,"bottom");return Object(D.a)({},e,{board:Object(D.a)({},e.board,{activeShape:y,lines:_(e.board.lines,y)})});case"LEFT":if(!e.board.activeShape)return e;var x=Object(D.a)({},e.board.activeShape,{column:$(e.board,e.board.activeShape,"left")?e.board.activeShape.column:e.board.activeShape.column-1});return Object(D.a)({},e,{board:Object(D.a)({},e.board,{activeShape:x,lines:_(e.board.lines,x)})});case"RIGHT":if(!e.board.activeShape)return e;var E=Object(D.a)({},e.board.activeShape,{column:$(e.board,e.board.activeShape,"right")?e.board.activeShape.column:e.board.activeShape.column+1});return Object(D.a)({},e,{board:Object(D.a)({},e.board,{activeShape:E,lines:_(e.board.lines,E)})});case"ROTATE":if(!e.board.activeShape)return e;var g=Object(D.a)({},e.board.activeShape,{position:Q(e.board.activeShape.position)});return(S=e.board,void 0!==J(j=g).find(function(e){var t=["left","right","bottom","top"].find(function(t){return Y(e,t,j)}),n=!1,r=S.lines[q(O,e.y)];if(r){var a=r[e.x];n=void 0!==a&&void 0!==a.partOfShape&&void 0!==a.partOfShape.shape&&void 0!==a.partOfShape.shape.id&&a.partOfShape.shape.id!==j.id}return!!t||!!n}))?e:Object(D.a)({},e,{board:Object(D.a)({},e.board,{activeShape:g,lines:_(e.board.lines,g)})});case"RESTART":return ee(e);default:return e}var S,j},ue=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=0,i=ie(null),o=function(){e(++a),i.current=setTimeout(function(){return c.current()},t())},c=ie(o);ne(function(){c.current=o});var u=ne;r&&(u=re),u(function(){return i.current=setTimeout(function(){return c.current()},t()),function(){return i.current?clearTimeout(i.current):void 0}},n)},le=function(e,t){return function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;n&&"function"===typeof n.preventDefault&&n.preventDefault(),t({type:e})}},se=function(e){return{BLAST:le("BLAST",e),DOWN:le("DOWN",e),LEFT:le("LEFT",e),PAUSE:le("PAUSE",e),RESTART:le("RESTART",e),RIGHT:le("RIGHT",e),ROTATE:le("ROTATE",e),THICK:le("THICK",e)}};function fe(){var e=te(ce,oe,function(){return oe}),t=Object(u.a)(e,2),n=t[0],r=t[1];ue(function(e){return r({type:"THICK",payload:e})},function(){return function(e){switch(!0){case 1===e:return 650;case 2===e:return 500;case 3===e:return 350;case 4===e:return 200;case 5===e:return 80;default:return E/(e+4)}}(n.level)},[n.level]);var a=se(r),i=ae(0),o=Object(u.a)(i,2),c=o[0],l=o[1];return ue(function(){var e=n.endDate&&n.startDate?Math.floor((n.endDate.getTime()-n.startDate.getTime())/1e3):n.startDate?Math.floor(((new Date).getTime()-n.startDate.getTime())/1e3):0;n.paused||l(e)},function(){return 250},[n.startDate,n.endDate,n.paused]),[n,c,a]}var de=n(61),pe=p(de.a)({alignItems:"center",justifyContent:"center"},function(e){e.theme;var t=e.type;return{borderRadius:"circle"===t?15:"pill"===t?15:4,borderWidth:1,height:"pill"===t?20:30,width:30}}),he=p(c.a)({},function(e){e.theme;return{}}),ve=p(l.a)({},function(e){return{fontSize:"pill"===e.type?8:20}}),be=function(e){var t=Object(r.useContext)(T),n=e.title,i=e.type||"square";return a.a.createElement(pe,Object(D.a)({},e,{theme:t,type:i||"square"}),a.a.createElement(he,{theme:t},a.a.createElement(ve,{theme:t,type:i},n)))},ye=n(112),me=function(e,t){return e.filter(function(e){return void 0!==e.keys.find(function(e){return String(e)===t.key})}).map(function(e){return{keyHandler:e,e:t}})},xe=Object(ye.throttle)(function(e,t){e.forEach(function(e){var n=e.keyHandler,r=e.e;n.handler(r.key,t)})},250);function Oe(e){Object(r.useEffect)(function(){var t=function(t){var n=me(e,t);n.length>0&&xe(n,t)};return b()&&window.addEventListener("keydown",t),function(){return b()?window.removeEventListener("keydown",t):void 0}},[])}var we=p(c.a)({alignItems:"center",display:"flex",zIndex:1},function(e){e.theme;return{}}),Ee=p(c.a)({alignItems:"center",display:"flex",flexDirection:"row"}),ge=function(e){var t=Object(r.useContext)(T),n=e.handlers;return Oe([{handler:n.up,keys:["ArrowUp","w"]},{handler:n.right,keys:["ArrowRight","d"]},{handler:n.left,keys:["ArrowLeft","a"]},{handler:n.down,keys:["ArrowDown","s"]}]),a.a.createElement(we,{theme:t},a.a.createElement(be,{accessibilityLabel:"up",title:"\u25b2",onPress:function(){return n.up()}}),a.a.createElement(Ee,null,a.a.createElement(be,{accessibilityLabel:"left button",title:"\u25c0",onPress:function(){return n.left()}}),a.a.createElement(be,{accessibilityLabel:"center",title:" ",onPress:function(){}}),a.a.createElement(be,{accessibilityLabel:"right",title:"\u25b6",onPress:function(){return n.right()}})),a.a.createElement(be,{accessibilityLabel:"down",title:"\u25bc",onPress:function(){return n.down()}}))},Se=p(c.a)({display:"flex",flexDirection:"row"},function(e){e.theme;return{}}),je=function(e){var t=Object(r.useContext)(T),n=e.handlers;return Oe([{handler:n.x,keys:["j","z"]},{handler:n.y,keys:["k","x"]}]),a.a.createElement(Se,{theme:t},a.a.createElement(be,{accessibilityLabel:"x button",title:"X",type:"circle",onPress:function(){return n.x()}}),a.a.createElement(be,{accessibilityLabel:"y button",title:"Y",type:"circle",onPress:function(){return n.y()}}))},Te=p(c.a)({display:"flex",flexDirection:"row",height:60},function(e){e.theme;return{}}),ke=function(e){var t=Object(r.useContext)(T),n=e.handlers;return Oe([{handler:n.select,keys:[" ","o"]},{handler:n.start,keys:["Enter","Escape"]}]),a.a.createElement(Te,{theme:t},a.a.createElement(be,{accessibilityLabel:"select button",title:"Select",type:"pill",onPress:function(){return n.select()}}),a.a.createElement(be,{accessibilityLabel:"start button",title:"Start",type:"pill",onPress:function(){return n.start()}}))},De=p(c.a)({alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"space-between",position:"relative",width:250,zIndex:1},function(e){e.theme;return{}}),Ae=function(e){var t=Object(r.useContext)(T),n=e.handlers;return a.a.createElement(De,{theme:t},a.a.createElement(ge,{handlers:n}),a.a.createElement(ke,{handlers:n}),a.a.createElement(je,{handlers:n}))},Le=p(c.a)({display:"flex",flexDirection:"row",flexWrap:"wrap",height:x*O,width:m*x}),Re=p(c.a)({border:"1px dashed rgba(0,0,0,.2)",height:24,width:m},function(e){var t=e.box,n=e.theme;return{backgroundColor:t.partOfShape?n.shapeColors[t.partOfShape.shape.type]:"white"}}),Ce=function(e){var t=Object(r.useContext)(T);return a.a.createElement(Re,Object(D.a)({},e,{theme:t}),a.a.createElement(y.Consumer,null,function(t){return t?a.a.createElement(l.a,null,e.line," / ",e.column):void 0}))},Ie=p(c.a)({display:"flex",flexDirection:"row",flexWrap:"wrap",width:4*m}),Pe=p(c.a)({display:"flex",flexDirection:"row"}),Me=p(c.a)({display:"flex",flexDirection:"column"}),He=p(c.a)({display:"flex",flexDirection:"row"}),ze=function(e){var t=e.theme,n=void 0===t?"default":t,r=fe(),i=Object(u.a)(r,3),o=i[0],c=i[1],s=i[2],f={down:s.DOWN,left:s.LEFT,right:s.RIGHT,select:s.RESTART,start:s.PAUSE,up:s.ROTATE,x:s.ROTATE,y:s.BLAST};return a.a.createElement(T.Provider,{value:j(n)},a.a.createElement(Pe,null,a.a.createElement(Me,null,a.a.createElement(He,null,a.a.createElement(y.Consumer,null,function(e){return e&&a.a.createElement(l.a,null,"Thicks: ",o.ticks)}),a.a.createElement(l.a,{accessibilityLabel:"time"},"Time: ",c),a.a.createElement(l.a,{accessibilityLabel:"lines"},"Lines: ",o.lines),a.a.createElement(l.a,{accessibilityLabel:"level"},"Level: ",o.level)),a.a.createElement(Ae,{handlers:f}),a.a.createElement(Le,null,o.board.lines.map(function(e,t){return e.map(function(e,n){return a.a.createElement(Ce,{key:"".concat(e.id),box:e,line:t,column:n})})}))),a.a.createElement(Me,null,o.board.previewBoards.map(function(e){return a.a.createElement(Ie,{key:"".concat(e.id)},e.lines.map(function(e,t){return e.map(function(e,n){return a.a.createElement(Ce,{key:"".concat(e.id),box:e,line:t,column:n})})}))}))))},Be=function(){return a.a.createElement(c.a,null,a.a.createElement(ze,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(Be,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[115,1,2]]]);
//# sourceMappingURL=main.e876625e.chunk.js.map